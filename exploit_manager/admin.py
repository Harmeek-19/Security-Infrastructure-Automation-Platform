# File: exploit_manager/admin.py
from django.contrib import admin
from .models import ExploitSource, Exploit, ExploitMatch

@admin.register(ExploitSource)
class ExploitSourceAdmin(admin.ModelAdmin):
    list_display = ['name', 'is_active', 'last_update']
    search_fields = ['name', 'description']

@admin.register(Exploit)
class ExploitAdmin(admin.ModelAdmin):
    list_display = ['exploit_id', 'title', 'source', 'cve_id', 'type', 'platform', 'date_published']
    list_filter = ['source', 'type', 'platform', 'verified']
    search_fields = ['exploit_id', 'title', 'description', 'cve_id']
    date_hierarchy = 'date_added'
    
    fieldsets = [
        ('Basic Information', {
            'fields': ['exploit_id', 'title', 'description', 'source']
        }),
        ('Classification', {
            'fields': ['type', 'platform', 'vulnerability_name', 'cve_id']
        }),
        ('Dates', {
            'fields': ['date_published']
        }),
        ('Details', {
            'fields': ['verified', 'score', 'source_url', 'author', 'code']
        }),
        ('Metadata', {
            'fields': ['metadata'],
            'classes': ['collapse']
        })
    ]

@admin.register(ExploitMatch)
class ExploitMatchAdmin(admin.ModelAdmin):
    list_display = ['vulnerability', 'exploit', 'confidence_score', 'status', 'matched_by', 'match_date']
    list_filter = ['status', 'matched_by']
    search_fields = ['vulnerability__name', 'exploit__title', 'match_reason', 'notes']
    date_hierarchy = 'match_date'
    
    fieldsets = [
        ('Match Information', {
            'fields': ['vulnerability', 'exploit', 'confidence_score', 'status']
        }),
        ('Match Details', {
            'fields': ['match_reason', 'matched_by', 'notes']
        })
    ]